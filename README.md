# exploit_Drupal_7
Exploit contra vulnerabilidades de drupal 6 y 7 (Information Disclosure - Authenticacion bypass)

# Descripcion

Exploit hecho en python que usa librerias urllib2, mechanize, BeautifulSoup 
El exploit lo que hace es automatizar peticiones http contra drupal para explotar dos vulnerabilidades que no estan correctamente catalogadas en las bases de datos de vulnerabilidades conocidas, a la fecha de escritura de los exploits la vulnerabilidad no habia sido reconocida publicamente por Drupal ni se le habia asignado codigo CVE, solo se encontro esta informacion en este link http://www.madirish.net/430 las vulnerabilidades son las siguientes:

# Vulnerabilidad # 1 Information disclosure

Es una web que tenga instalado drupal 7 o algunas versiones 6.x es posible hacer una peticion a la ruta:
http://vulnerable.com/admin/views/ajax/autocomplete/user/a al navegar alli la web mostrara todos los ID's de usuario que empiezan con la letra a, al navegar a la ruta http://vulnerable.com/admin/views/ajax/autocomplete/user/b la web mostrara todos los ID's de usuario que empiezan por la letra b y asi sucesivamente, solo se debe cambiar el ultimo parametro para extraer los datos

Posibles caracteres por lo que puede empezar un ID de usuario:
abcdefghijklmnopqrstuvwxyz.-123456789+

El script "enumeracion_ID_Usuarios_Drupal.py" automatiza la tarea de hacer peticiones a esa ruta cambiando el ultimo parametro, haciendo posible extraer todos los Id's de usuario de la web, un ejemplo de un ID obtenido es este: A011074081

Dicho listado de ID's de usuarios se guarda en un archivo de texto que luego se usara para explotar la vulnerabilidad # 2

# Vulnerabilidad # 2 Authentication bypass

Con cada ID de usuario encontrado en la vulnerabilidad anterior es posible loguearse en el sistema ingresando el ID en el campo de usuario y contrasenha.

El script "single_Extraccion_Datos_Usuarios_Drupal.py" lo que hace es loguearse como cada usuario y dar click a un link donde esta toda la informacion de usuario como cedula, correo, telefono, nombre completo, direccion, el script debe modificarse dependiendo de la instalacion de drupal especifica que se explote, por que en la web que se hizo la prueba los datos de usuario estaban accesibles dandole click a un link que decia "Hola" , se automatiza el logueo, navegcion y click con ayuda de las librerias de python mechanize y BeautifulSoup.

# Instrucciones de uso

* Se debe tener instalado python 2.7.x
* Se deben tener instaladas las librerias mechanize y BeautifulSoup de no tenerlas se pueden instalar con el comando "pip install beautifulsoup", en caso de no tener pip instalado que es el gestor de librerias de python se puede instalar con el comando desde la terminal de linux "apt-get -y install python-pip"
* Descargar los scripts, editarlos para cambiar la ruta base de la web a explotar, en los scripts es "http://vulnerable.com", cambiar por la ruta de la web objtivo y ejecutarlos.
